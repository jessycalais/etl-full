2025-08-22 19:49:12,072 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-22 19:49:12,073 - INFO - ler_planilha executada com excesso!
2025-08-22 19:49:12,186 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-22 19:49:12,186 - INFO - ler_planilha executada com excesso!
2025-08-22 19:49:12,227 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-22 19:49:12,227 - INFO - ler_planilha executada com excesso!
2025-08-22 19:49:12,239 - INFO - limpar_ruptura executada com excesso!
2025-08-22 19:49:12,241 - INFO - limpar_estoque executada com excesso!
2025-08-22 19:49:12,244 - INFO - limpar_vendas executada com excesso!
2025-08-22 19:49:12,276 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-22 19:49:12,276 - INFO - validar_df executada com excesso!
2025-08-22 19:49:12,294 - INFO - DataFrame validado com sucesso: estoque!
2025-08-22 19:49:12,294 - INFO - validar_df executada com excesso!
2025-08-22 19:49:12,304 - INFO - DataFrame validado com sucesso: vendas!
2025-08-22 19:49:12,304 - INFO - validar_df executada com excesso!
2025-08-22 19:49:12,310 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-22 19:49:12,310 - INFO - combinar_abas executada com excesso!
2025-08-22 19:49:12,314 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-22 19:49:12,314 - INFO - combinar_abas executada com excesso!
2025-08-22 19:49:12,320 - INFO - limpar_consolidado executada com excesso!
2025-08-22 19:49:12,334 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-22 19:49:12,335 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-22 19:49:12,400 - INFO - Planilhas individuais salvas com sucesso.
2025-08-22 19:49:12,400 - INFO - exportar_por_cliente executada com excesso!
2025-08-22 19:49:12,694 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-22 19:49:12,695 - INFO - exportar_xlsx executada com excesso!
2025-08-22 19:49:12,908 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-22 19:49:12,908 - INFO - exportar_xlsx executada com excesso!
2025-08-22 19:49:12,939 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-22 19:49:12,939 - INFO - exportar_xlsx executada com excesso!
2025-08-22 19:49:12,941 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-22 19:49:14,372 - INFO - Dataset casegb-469522.varejo criado ou já existente.
2025-08-22 19:49:14,372 - INFO - _criar_dataset executada com excesso!
2025-08-22 19:49:17,951 - INFO - Tabela "casegb-469522.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-22 19:49:17,951 - INFO - enviar_tabela_bq executada com excesso!
2025-08-22 19:49:17,957 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-22 19:49:19,374 - INFO - Dataset casegb-469522.varejo criado ou já existente.
2025-08-22 19:49:19,374 - INFO - _criar_dataset executada com excesso!
2025-08-22 19:49:22,560 - INFO - Tabela "casegb-469522.varejo.estoque" criada e dados enviados com sucesso!
2025-08-22 19:49:22,560 - INFO - enviar_tabela_bq executada com excesso!
2025-08-22 19:49:22,566 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-22 19:49:24,066 - INFO - Dataset casegb-469522.varejo criado ou já existente.
2025-08-22 19:49:24,066 - INFO - _criar_dataset executada com excesso!
2025-08-22 19:49:27,178 - INFO - Tabela "casegb-469522.varejo.vendas" criada e dados enviados com sucesso!
2025-08-22 19:49:27,178 - INFO - enviar_tabela_bq executada com excesso!
2025-08-22 19:49:27,180 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-22 19:49:28,466 - INFO - Dataset casegb-469522.varejo criado ou já existente.
2025-08-22 19:49:28,466 - INFO - _criar_dataset executada com excesso!
2025-08-22 19:49:31,899 - INFO - Tabela "casegb-469522.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-22 19:49:31,899 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:38:38,867 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 18:38:38,868 - INFO - ler_planilha executada com excesso!
2025-08-26 18:38:39,136 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 18:38:39,136 - INFO - ler_planilha executada com excesso!
2025-08-26 18:38:39,209 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 18:38:39,209 - INFO - ler_planilha executada com excesso!
2025-08-26 18:38:39,269 - INFO - limpar_ruptura executada com excesso!
2025-08-26 18:38:39,275 - INFO - limpar_estoque executada com excesso!
2025-08-26 18:38:39,284 - INFO - limpar_vendas executada com excesso!
2025-08-26 18:38:39,416 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 18:38:39,417 - INFO - validar_df executada com excesso!
2025-08-26 18:38:39,463 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 18:38:39,463 - INFO - validar_df executada com excesso!
2025-08-26 18:38:39,489 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 18:38:39,489 - INFO - validar_df executada com excesso!
2025-08-26 18:38:39,518 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:38:39,518 - INFO - combinar_abas executada com excesso!
2025-08-26 18:38:39,527 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:38:39,527 - INFO - combinar_abas executada com excesso!
2025-08-26 18:38:39,544 - INFO - limpar_consolidado executada com excesso!
2025-08-26 18:38:39,582 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 18:38:39,583 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 18:38:39,732 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 18:38:39,733 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 18:38:40,364 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 18:38:40,364 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:38:40,742 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 18:38:40,742 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:38:40,794 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 18:38:40,794 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:38:40,825 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:38:43,190 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:43,190 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:38:44,615 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:44,615 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:38:44,621 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:38:46,691 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:46,692 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:38:47,438 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:47,438 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:38:47,443 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:38:49,480 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:49,481 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:38:50,759 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:50,760 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:38:50,767 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:38:53,482 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:53,482 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:38:54,136 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:38:54,137 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:40:01,061 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 18:40:01,061 - INFO - ler_planilha executada com excesso!
2025-08-26 18:40:01,243 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 18:40:01,243 - INFO - ler_planilha executada com excesso!
2025-08-26 18:40:01,332 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 18:40:01,332 - INFO - ler_planilha executada com excesso!
2025-08-26 18:40:01,361 - INFO - limpar_ruptura executada com excesso!
2025-08-26 18:40:01,365 - INFO - limpar_estoque executada com excesso!
2025-08-26 18:40:01,372 - INFO - limpar_vendas executada com excesso!
2025-08-26 18:40:01,457 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 18:40:01,458 - INFO - validar_df executada com excesso!
2025-08-26 18:40:01,502 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 18:40:01,502 - INFO - validar_df executada com excesso!
2025-08-26 18:40:01,530 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 18:40:01,531 - INFO - validar_df executada com excesso!
2025-08-26 18:40:01,543 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:40:01,543 - INFO - combinar_abas executada com excesso!
2025-08-26 18:40:01,554 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:40:01,554 - INFO - combinar_abas executada com excesso!
2025-08-26 18:40:01,568 - INFO - limpar_consolidado executada com excesso!
2025-08-26 18:40:01,604 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 18:40:01,604 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 18:40:01,716 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 18:40:01,716 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 18:40:02,167 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 18:40:02,168 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:40:02,545 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 18:40:02,545 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:40:02,601 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 18:40:02,601 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:40:02,605 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:40:04,780 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:04,780 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:40:05,541 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:05,542 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:40:05,545 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:40:07,480 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:07,480 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:40:08,208 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:08,209 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:40:08,214 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:40:10,059 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:10,060 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:40:11,348 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:11,348 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:40:11,354 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:40:13,073 - ERROR - Erro ao criar dataset: 403 POST https://bigquery.googleapis.com/bigquery/v2/projects/poetic-standard-439816-e6/datasets?prettyPrint=false: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.datasets.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:13,074 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:40:14,272 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Project poetic-standard-439816-e6: User does not have bigquery.jobs.create permission in project poetic-standard-439816-e6.
2025-08-26 18:40:14,273 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:43:15,085 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 18:43:15,085 - INFO - ler_planilha executada com excesso!
2025-08-26 18:43:15,474 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 18:43:15,474 - INFO - ler_planilha executada com excesso!
2025-08-26 18:43:15,532 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 18:43:15,532 - INFO - ler_planilha executada com excesso!
2025-08-26 18:43:15,550 - INFO - limpar_ruptura executada com excesso!
2025-08-26 18:43:15,553 - INFO - limpar_estoque executada com excesso!
2025-08-26 18:43:15,557 - INFO - limpar_vendas executada com excesso!
2025-08-26 18:43:15,616 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 18:43:15,617 - INFO - validar_df executada com excesso!
2025-08-26 18:43:15,689 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 18:43:15,690 - INFO - validar_df executada com excesso!
2025-08-26 18:43:15,742 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 18:43:15,743 - INFO - validar_df executada com excesso!
2025-08-26 18:43:15,769 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:43:15,769 - INFO - combinar_abas executada com excesso!
2025-08-26 18:43:15,788 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:43:15,788 - INFO - combinar_abas executada com excesso!
2025-08-26 18:43:15,816 - INFO - limpar_consolidado executada com excesso!
2025-08-26 18:43:15,884 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 18:43:15,884 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 18:43:16,178 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 18:43:16,180 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 18:43:16,882 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 18:43:16,882 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:43:17,385 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 18:43:17,386 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:43:17,450 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 18:43:17,450 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:43:17,455 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:43:20,972 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:43:20,972 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:43:22,938 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:43:22,939 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:43:22,944 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:43:25,534 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:43:25,534 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:43:26,929 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:43:26,929 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:43:26,931 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:43:29,135 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:43:29,136 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:43:30,532 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:43:30,532 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:43:30,535 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:43:33,246 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:43:33,246 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:43:34,613 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:43:34,614 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:46:00,758 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 18:46:00,759 - INFO - ler_planilha executada com excesso!
2025-08-26 18:46:01,050 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 18:46:01,050 - INFO - ler_planilha executada com excesso!
2025-08-26 18:46:01,137 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 18:46:01,137 - INFO - ler_planilha executada com excesso!
2025-08-26 18:46:01,167 - INFO - limpar_ruptura executada com excesso!
2025-08-26 18:46:01,172 - INFO - limpar_estoque executada com excesso!
2025-08-26 18:46:01,180 - INFO - limpar_vendas executada com excesso!
2025-08-26 18:46:01,257 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 18:46:01,257 - INFO - validar_df executada com excesso!
2025-08-26 18:46:01,301 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 18:46:01,301 - INFO - validar_df executada com excesso!
2025-08-26 18:46:01,320 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 18:46:01,320 - INFO - validar_df executada com excesso!
2025-08-26 18:46:01,329 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:46:01,329 - INFO - combinar_abas executada com excesso!
2025-08-26 18:46:01,337 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:46:01,337 - INFO - combinar_abas executada com excesso!
2025-08-26 18:46:01,352 - INFO - limpar_consolidado executada com excesso!
2025-08-26 18:46:01,385 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 18:46:01,385 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 18:46:01,514 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 18:46:01,515 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 18:46:02,350 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 18:46:02,351 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:46:02,932 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 18:46:02,932 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:46:03,040 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 18:46:03,040 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:46:03,047 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:46:06,541 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:46:06,541 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:46:08,211 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:46:08,211 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:46:08,217 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:46:10,932 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:46:10,932 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:46:12,320 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:46:12,320 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:46:12,324 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:46:14,735 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:46:14,735 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:46:16,198 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:46:16,198 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:46:16,204 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:46:18,635 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:46:18,635 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:46:19,820 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:46:19,820 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:49:21,208 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 18:49:21,209 - INFO - ler_planilha executada com excesso!
2025-08-26 18:49:21,388 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 18:49:21,388 - INFO - ler_planilha executada com excesso!
2025-08-26 18:49:21,430 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 18:49:21,430 - INFO - ler_planilha executada com excesso!
2025-08-26 18:49:21,479 - INFO - limpar_ruptura executada com excesso!
2025-08-26 18:49:21,484 - INFO - limpar_estoque executada com excesso!
2025-08-26 18:49:21,490 - INFO - limpar_vendas executada com excesso!
2025-08-26 18:49:21,586 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 18:49:21,586 - INFO - validar_df executada com excesso!
2025-08-26 18:49:21,638 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 18:49:21,638 - INFO - validar_df executada com excesso!
2025-08-26 18:49:21,667 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 18:49:21,667 - INFO - validar_df executada com excesso!
2025-08-26 18:49:21,692 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:49:21,692 - INFO - combinar_abas executada com excesso!
2025-08-26 18:49:21,702 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:49:21,702 - INFO - combinar_abas executada com excesso!
2025-08-26 18:49:21,721 - INFO - limpar_consolidado executada com excesso!
2025-08-26 18:49:21,758 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 18:49:21,758 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 18:49:21,911 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 18:49:21,912 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 18:49:22,455 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 18:49:22,455 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:49:22,905 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 18:49:22,906 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:49:22,974 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 18:49:22,974 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:49:23,002 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:49:25,338 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:49:25,338 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:49:27,039 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:49:27,040 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:49:27,045 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:49:29,032 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:49:29,032 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:49:30,433 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:49:30,433 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:49:30,438 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:49:32,234 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:49:32,234 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:49:33,536 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:49:33,536 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:49:33,542 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:49:35,236 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:49:35,237 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:49:36,548 - ERROR - Erro ao enviar dados para o BigQuery: 403 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/poetic-standard-439816-e6/jobs?uploadType=multipart: Access Denied: Dataset casegb-469522:varejo: Permission bigquery.tables.create denied on dataset casegb-469522:varejo (or it may not exist).
2025-08-26 18:49:36,548 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:52:52,486 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 18:52:52,486 - INFO - ler_planilha executada com excesso!
2025-08-26 18:52:52,766 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 18:52:52,766 - INFO - ler_planilha executada com excesso!
2025-08-26 18:52:52,837 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 18:52:52,837 - INFO - ler_planilha executada com excesso!
2025-08-26 18:52:52,859 - INFO - limpar_ruptura executada com excesso!
2025-08-26 18:52:52,863 - INFO - limpar_estoque executada com excesso!
2025-08-26 18:52:52,870 - INFO - limpar_vendas executada com excesso!
2025-08-26 18:52:52,940 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 18:52:52,940 - INFO - validar_df executada com excesso!
2025-08-26 18:52:52,975 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 18:52:52,975 - INFO - validar_df executada com excesso!
2025-08-26 18:52:53,008 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 18:52:53,008 - INFO - validar_df executada com excesso!
2025-08-26 18:52:53,020 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:52:53,020 - INFO - combinar_abas executada com excesso!
2025-08-26 18:52:53,027 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 18:52:53,027 - INFO - combinar_abas executada com excesso!
2025-08-26 18:52:53,037 - INFO - limpar_consolidado executada com excesso!
2025-08-26 18:52:53,058 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 18:52:53,058 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 18:52:53,150 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 18:52:53,151 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 18:52:53,752 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 18:52:53,752 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:52:54,218 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 18:52:54,218 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:52:54,303 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 18:52:54,303 - INFO - exportar_xlsx executada com excesso!
2025-08-26 18:52:54,307 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:52:56,435 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:52:56,435 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:52:59,826 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 18:52:59,827 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:52:59,832 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:53:02,029 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:53:02,029 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:53:04,779 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 18:53:04,779 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:53:04,782 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:53:07,034 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:53:07,034 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:53:10,258 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 18:53:10,259 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 18:53:10,262 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 18:53:13,137 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 18:53:13,137 - INFO - _criar_dataset executada com excesso!
2025-08-26 18:53:16,833 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 18:53:16,833 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:08:38,877 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 19:08:38,877 - INFO - ler_planilha executada com excesso!
2025-08-26 19:08:39,053 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 19:08:39,053 - INFO - ler_planilha executada com excesso!
2025-08-26 19:08:39,110 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 19:08:39,110 - INFO - ler_planilha executada com excesso!
2025-08-26 19:08:39,145 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:08:39,148 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:08:39,152 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:08:39,217 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:08:39,217 - INFO - validar_df executada com excesso!
2025-08-26 19:08:39,245 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:08:39,245 - INFO - validar_df executada com excesso!
2025-08-26 19:08:39,260 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:08:39,260 - INFO - validar_df executada com excesso!
2025-08-26 19:08:39,280 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:08:39,280 - INFO - combinar_abas executada com excesso!
2025-08-26 19:08:39,291 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:08:39,291 - INFO - combinar_abas executada com excesso!
2025-08-26 19:08:39,310 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:08:39,348 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:08:39,348 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:08:39,556 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:08:39,557 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:08:40,184 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:08:40,185 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:08:40,788 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:08:40,788 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:08:40,870 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:08:40,870 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:08:40,871 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:08:40,878 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:08:40,881 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:08:40,884 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:09:58,806 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": [Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx'
2025-08-26 19:09:58,806 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 16, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
        content_or_path=path_or_buffer, storage_options=storage_options
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ~~~~~~~~~~^
        content_or_path, "rb", storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as handle:
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 21, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro ([Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx') ao tentar ler a planilha!
2025-08-26 19:09:58,867 - ERROR - Erro ao ler a planilha "02_BD_Estoque": [Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx'
2025-08-26 19:09:58,867 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 16, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
        content_or_path=path_or_buffer, storage_options=storage_options
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ~~~~~~~~~~^
        content_or_path, "rb", storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as handle:
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 21, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro ([Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx') ao tentar ler a planilha!
2025-08-26 19:09:58,869 - ERROR - Erro ao ler a planilha "03_BD_Vendas": [Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx'
2025-08-26 19:09:58,869 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 16, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
        content_or_path=path_or_buffer, storage_options=storage_options
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ~~~~~~~~~~^
        content_or_path, "rb", storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ) as handle:
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 21, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro ([Errno 2] No such file or directory: 'C:\\Users\\Acer\\Downloads\\VS_Code\\Projetos e Estudos\\- PROCESSO SELETIVO - PREPARAÇÃO\\12. Cases Técnicos\\case_gb\\data\\raw\\02_Case_Analista de Dados_ Dados.xlsx') ao tentar ler a planilha!
2025-08-26 19:09:58,871 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:09:58,873 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:09:58,873 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:09:58,874 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:09:58,877 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:09:58,878 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:09:58,879 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:09:58,880 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:09:58,900 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:09:58,900 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:09:58,901 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:09:58,902 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:09:58,903 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:09:58,904 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:09:58,905 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:09:58,906 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:09:58,907 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:09:58,907 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:09:58,909 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:09:58,909 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:09:58,910 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:09:58,911 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:09:58,912 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:09:58,914 - ERROR - Erro em enviar_tabela_bq
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 35, in enviar_tabela_bq
    cliente = _criar_conexao_bq()
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_bigquery.py", line 19, in _criar_conexao_bq
    cliente = bigquery.Client.from_service_account_json('credentials_streamlit.json')
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\google\cloud\client\__init__.py", line 113, in from_service_account_json
    with io.open(json_credentials_path, "r", encoding="utf-8") as json_fi:
         ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'credentials_streamlit.json'
2025-08-26 19:41:54,012 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:41:54,014 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:41:54,019 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:41:54,077 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:41:54,077 - INFO - validar_df executada com excesso!
2025-08-26 19:41:54,104 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:41:54,104 - INFO - validar_df executada com excesso!
2025-08-26 19:41:54,121 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:41:54,121 - INFO - validar_df executada com excesso!
2025-08-26 19:41:54,142 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:41:54,143 - INFO - combinar_abas executada com excesso!
2025-08-26 19:41:54,152 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:41:54,153 - INFO - combinar_abas executada com excesso!
2025-08-26 19:41:54,168 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:41:54,193 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:41:54,193 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:41:54,308 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:41:54,308 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:41:54,601 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:41:54,601 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:41:54,886 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:41:54,886 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:41:54,929 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:41:54,930 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:41:54,933 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:41:56,516 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:41:56,516 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:01,246 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 19:42:01,246 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:01,249 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:02,718 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:02,718 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:06,001 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 19:42:06,002 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:06,003 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:07,410 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:07,411 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:10,509 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 19:42:10,509 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:10,512 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:11,910 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:11,911 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:14,628 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 19:42:14,629 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:23,586 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:42:23,588 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:42:23,591 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:42:23,605 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:42:23,605 - INFO - validar_df executada com excesso!
2025-08-26 19:42:23,624 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:42:23,625 - INFO - validar_df executada com excesso!
2025-08-26 19:42:23,638 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:42:23,638 - INFO - validar_df executada com excesso!
2025-08-26 19:42:23,644 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:42:23,644 - INFO - combinar_abas executada com excesso!
2025-08-26 19:42:23,648 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:42:23,648 - INFO - combinar_abas executada com excesso!
2025-08-26 19:42:23,655 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:42:23,669 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:42:23,670 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:42:23,751 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:42:23,752 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:42:24,016 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:42:24,016 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:42:24,261 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:42:24,262 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:42:24,295 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:42:24,295 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:42:24,296 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:25,512 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:25,512 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:28,409 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 19:42:28,409 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:28,411 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:29,810 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:29,811 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:33,308 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 19:42:33,309 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:33,311 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:34,822 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:34,822 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:37,215 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 19:42:37,215 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:42:37,221 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:42:38,516 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:42:38,517 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:42:42,354 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 19:42:42,354 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:44:16,371 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:44:16,372 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:44:16,375 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:44:16,387 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:44:16,387 - INFO - validar_df executada com excesso!
2025-08-26 19:44:16,405 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:44:16,405 - INFO - validar_df executada com excesso!
2025-08-26 19:44:16,416 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:44:16,416 - INFO - validar_df executada com excesso!
2025-08-26 19:44:16,421 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:44:16,421 - INFO - combinar_abas executada com excesso!
2025-08-26 19:44:16,425 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:44:16,425 - INFO - combinar_abas executada com excesso!
2025-08-26 19:44:16,431 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:44:16,445 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:44:16,445 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:44:16,546 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:44:16,547 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:44:16,889 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:44:16,889 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:44:17,309 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:44:17,310 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:44:17,360 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:44:17,360 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:44:17,363 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:44:18,817 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:44:18,817 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:44:22,489 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 19:44:22,490 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:44:22,496 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:44:23,813 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:44:23,813 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:44:27,279 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 19:44:27,279 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:44:27,286 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:44:28,811 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:44:28,811 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:44:31,840 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 19:44:31,841 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:44:31,847 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:44:33,207 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:44:33,207 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:44:36,266 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 19:44:36,267 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:46:23,518 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:46:23,520 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:46:23,521 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:46:23,521 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:46:23,525 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:46:23,526 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:46:23,528 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:46:23,534 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:46:23,537 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:46:23,539 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed
2025-08-26 19:46:23,539 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:46:23,549 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:46:23,550 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:46:23,552 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:46:23,555 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:46:23,555 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:46:23,558 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:46:23,560 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:46:23,560 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:46:23,565 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:46:23,565 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:46:23,570 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:46:23,570 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:46:23,574 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:46:25,116 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:46:25,116 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:46:25,117 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:46:25,118 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:46:25,121 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:46:26,409 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:46:26,410 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:46:26,410 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:46:26,410 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:46:26,411 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:46:27,913 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:46:27,913 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:46:27,913 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:46:27,913 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:46:27,915 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:46:29,207 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:46:29,207 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:46:29,208 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:46:29,208 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:05,720 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:47:05,725 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:47:05,726 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:47:05,727 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:47:05,729 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:47:05,731 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:47:05,767 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:47:05,771 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:47:05,774 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:47:05,777 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed
2025-08-26 19:47:05,777 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:47:05,781 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:47:05,781 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:47:05,782 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:47:05,784 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:47:05,784 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:47:05,786 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:47:05,789 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:05,789 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:05,792 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:05,792 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:05,794 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:05,794 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:05,799 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:07,510 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:07,510 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:07,510 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:47:07,510 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:07,513 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:09,012 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:09,012 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:09,012 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:47:09,012 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:09,015 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:10,608 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:10,608 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:10,608 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:47:10,609 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:10,614 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:12,014 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:12,014 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:12,014 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:47:12,014 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:19,270 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:47:19,271 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:47:19,273 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:47:19,274 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:47:19,277 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:47:19,277 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:47:19,279 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:47:19,281 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:47:19,283 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:47:19,287 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed
2025-08-26 19:47:19,289 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:47:19,292 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:47:19,292 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:47:19,294 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:47:19,297 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:47:19,297 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:47:19,299 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:47:19,301 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:19,301 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:19,305 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:19,305 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:19,308 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:19,309 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:47:19,313 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:20,809 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:20,809 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:20,810 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:47:20,810 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:20,811 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:22,208 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:22,208 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:22,208 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:47:22,209 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:22,211 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:23,504 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:23,505 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:23,505 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:47:23,505 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:47:23,507 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:47:24,910 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:47:24,910 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:47:24,910 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:47:24,910 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:50:31,141 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:50:31,143 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:50:31,146 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:50:31,147 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:50:31,149 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:50:31,150 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:50:31,171 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:50:31,173 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:50:31,174 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:50:31,176 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed
2025-08-26 19:50:31,176 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:50:31,179 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:50:31,179 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:50:31,180 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:50:31,181 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:50:31,181 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:50:31,182 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:50:31,184 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:50:31,184 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:50:31,185 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:50:31,185 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:50:31,186 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:50:31,186 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:50:31,190 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:50:32,608 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:50:32,609 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:50:32,610 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:50:32,610 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:50:32,616 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:50:34,004 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:50:34,005 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:50:34,006 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:50:34,006 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:50:34,009 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:50:35,308 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:50:35,308 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:50:35,309 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:50:35,309 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:50:35,311 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:50:36,710 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:50:36,711 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:50:36,711 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:50:36,712 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:16,755 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:52:16,756 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:52:16,756 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:52:16,757 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:52:16,758 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:52:16,760 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:52:16,762 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:52:16,766 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:52:16,769 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:52:16,771 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed
2025-08-26 19:52:16,771 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:52:16,773 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:52:16,773 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:52:16,774 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:52:16,775 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:52:16,776 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:52:16,777 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:52:16,780 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:16,780 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:16,784 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:16,785 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:16,787 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:16,787 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:16,790 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:18,308 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:18,308 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:18,308 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:52:18,308 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:18,310 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:19,504 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:19,504 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:19,504 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:52:19,504 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:19,507 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:20,906 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:20,906 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:20,907 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:52:20,907 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:20,911 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:22,605 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:22,605 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:22,605 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:52:22,605 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:43,734 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:52:43,736 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:52:43,737 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
TypeError: ler_planilha() got an unexpected keyword argument 'sheet_name'
2025-08-26 19:52:43,738 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:52:43,740 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:52:43,743 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'TypeError' object has no attribute 'pipe'
2025-08-26 19:52:43,766 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:52:43,769 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:52:43,770 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'TypeError'>). Looked up the following base classes: (<class 'TypeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:52:43,772 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed
2025-08-26 19:52:43,772 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'TypeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:52:43,775 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:52:43,775 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:52:43,776 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:52:43,778 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:52:43,778 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:52:43,779 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:52:43,780 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:43,780 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:43,782 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:43,782 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:43,784 - ERROR - Erro ao gerar xlsx: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:43,784 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'TypeError' object has no attribute 'to_excel'
2025-08-26 19:52:43,786 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:45,209 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:45,209 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:45,210 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:52:45,210 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:45,212 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:46,507 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:46,507 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:46,507 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:52:46,507 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:46,509 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:47,803 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:47,803 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:47,803 - ERROR - Erro ao enviar dados para o BigQuery: 'TypeError' object has no attribute 'reset_index'
2025-08-26 19:52:47,804 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:52:47,806 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:52:49,112 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:52:49,112 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:52:49,113 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:52:49,113 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:54:06,843 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:54:06,846 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:54:06,849 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:54:06,883 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:54:06,883 - INFO - validar_df executada com excesso!
2025-08-26 19:54:06,906 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:54:06,906 - INFO - validar_df executada com excesso!
2025-08-26 19:54:06,921 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:54:06,922 - INFO - validar_df executada com excesso!
2025-08-26 19:54:06,928 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:54:06,928 - INFO - combinar_abas executada com excesso!
2025-08-26 19:54:06,933 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:54:06,933 - INFO - combinar_abas executada com excesso!
2025-08-26 19:54:06,939 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:54:06,957 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:54:06,957 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:54:07,041 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:54:07,041 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:54:07,321 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:54:07,321 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:54:07,592 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:54:07,592 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:54:07,630 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:54:07,630 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:54:07,632 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:54:09,018 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:54:09,018 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:54:12,598 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 19:54:12,598 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:54:12,602 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:54:13,910 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:54:13,911 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:54:16,495 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 19:54:16,496 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:54:16,502 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:54:17,803 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:54:17,803 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:54:20,612 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 19:54:20,612 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:54:20,615 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:54:21,801 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:54:21,802 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:54:24,588 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 19:54:24,588 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:55:24,476 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 19:55:24,476 - INFO - ler_planilha executada com excesso!
2025-08-26 19:55:24,616 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 19:55:24,616 - INFO - ler_planilha executada com excesso!
2025-08-26 19:55:24,658 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 19:55:24,658 - INFO - ler_planilha executada com excesso!
2025-08-26 19:55:24,676 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:55:24,680 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:55:24,687 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:55:24,710 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:55:24,710 - INFO - validar_df executada com excesso!
2025-08-26 19:55:24,737 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:55:24,738 - INFO - validar_df executada com excesso!
2025-08-26 19:55:24,760 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:55:24,760 - INFO - validar_df executada com excesso!
2025-08-26 19:55:24,766 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:55:24,767 - INFO - combinar_abas executada com excesso!
2025-08-26 19:55:24,772 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:55:24,772 - INFO - combinar_abas executada com excesso!
2025-08-26 19:55:24,786 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:55:24,807 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:55:24,807 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:55:24,899 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:55:24,900 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:55:25,169 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:55:25,169 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:55:25,404 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:55:25,404 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:55:25,440 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:55:25,440 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:55:25,441 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:55:26,905 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:55:26,905 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:55:30,158 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 19:55:30,158 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:55:30,165 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:55:31,508 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:55:31,509 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:55:33,963 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 19:55:33,963 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:55:33,965 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:55:35,207 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:55:35,207 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:55:37,900 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 19:55:37,900 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:55:37,902 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:55:39,801 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:55:39,802 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:55:42,769 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 19:55:42,769 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:14,021 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 19:57:14,022 - INFO - ler_planilha executada com excesso!
2025-08-26 19:57:14,165 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 19:57:14,165 - INFO - ler_planilha executada com excesso!
2025-08-26 19:57:14,215 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 19:57:14,215 - INFO - ler_planilha executada com excesso!
2025-08-26 19:57:14,232 - INFO - limpar_ruptura executada com excesso!
2025-08-26 19:57:14,236 - INFO - limpar_estoque executada com excesso!
2025-08-26 19:57:14,240 - INFO - limpar_vendas executada com excesso!
2025-08-26 19:57:14,263 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 19:57:14,264 - INFO - validar_df executada com excesso!
2025-08-26 19:57:14,290 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 19:57:14,291 - INFO - validar_df executada com excesso!
2025-08-26 19:57:14,308 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 19:57:14,308 - INFO - validar_df executada com excesso!
2025-08-26 19:57:14,317 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:57:14,317 - INFO - combinar_abas executada com excesso!
2025-08-26 19:57:14,326 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 19:57:14,326 - INFO - combinar_abas executada com excesso!
2025-08-26 19:57:14,340 - INFO - limpar_consolidado executada com excesso!
2025-08-26 19:57:14,366 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 19:57:14,366 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 19:57:14,476 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 19:57:14,477 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 19:57:14,754 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 19:57:14,754 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:57:14,979 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 19:57:14,979 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:57:15,011 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 19:57:15,011 - INFO - exportar_xlsx executada com excesso!
2025-08-26 19:57:15,012 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:16,404 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:16,404 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:23,791 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 19:57:23,791 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 19:57:23,825 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 19:57:23,825 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 19:57:23,831 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 19:57:23,832 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 19:57:23,833 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:57:23,834 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:57:23,835 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:57:23,836 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:57:23,838 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:57:23,839 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:57:23,840 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:57:23,840 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:57:23,842 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:57:23,842 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:57:23,844 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:57:23,846 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:57:23,846 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:57:23,847 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:57:23,848 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:57:23,848 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:57:23,850 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:57:23,850 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:57:23,852 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:57:23,852 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:57:23,857 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:25,408 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:25,408 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:25,409 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 19:57:25,409 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:25,413 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:26,702 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:26,703 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:26,703 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 19:57:26,703 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:26,707 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:27,085 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 19:57:27,085 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:27,087 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:28,002 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:28,002 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:28,002 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 19:57:28,002 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:28,004 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:28,503 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:28,503 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:29,400 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:29,401 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:29,402 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:57:29,402 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:31,551 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 19:57:31,552 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:31,558 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:32,799 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:32,799 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:35,647 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 19:57:35,648 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:57:35,654 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:57:36,903 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:57:36,904 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:57:41,744 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 19:57:41,744 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:58:24,796 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 19:58:24,796 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 19:58:24,809 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 19:58:24,809 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 19:58:24,816 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 19:58:24,816 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 19:58:24,818 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:58:24,819 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:58:24,820 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:58:24,821 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:58:24,822 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:58:24,823 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 19:58:24,824 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:58:24,825 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:58:24,826 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 19:58:24,826 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 19:58:24,827 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 19:58:24,828 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:58:24,828 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 19:58:24,829 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 19:58:24,831 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:58:24,831 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:58:24,833 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:58:24,833 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:58:24,835 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:58:24,835 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 19:58:24,838 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:58:26,307 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:58:26,307 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:58:26,308 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 19:58:26,308 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:58:26,312 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:58:27,606 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:58:27,606 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:58:27,606 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 19:58:27,606 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:58:27,608 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:58:28,907 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:58:28,907 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:58:28,908 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 19:58:28,908 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 19:58:28,912 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 19:58:30,201 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 19:58:30,201 - INFO - _criar_dataset executada com excesso!
2025-08-26 19:58:30,202 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 19:58:30,202 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:34,640 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:00:34,641 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:00:34,652 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:00:34,653 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:00:34,658 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:00:34,658 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:00:34,660 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:34,661 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:34,662 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:34,676 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:00:34,678 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:00:34,679 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:00:34,680 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:00:34,680 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:00:34,682 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:00:34,682 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:00:34,683 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:34,684 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:00:34,684 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:00:34,685 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:00:34,686 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:34,686 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:34,688 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:34,688 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:34,689 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:34,689 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:34,691 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:36,104 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:36,104 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:36,105 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:00:36,105 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:36,111 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:37,506 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:37,506 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:37,507 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:00:37,507 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:37,512 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:38,903 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:38,903 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:38,903 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:00:38,903 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:38,906 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:40,202 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:40,203 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:40,203 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:00:40,203 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:50,310 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:00:50,310 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:00:50,318 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:00:50,318 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:00:50,327 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:00:50,327 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:00:50,329 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:50,330 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:50,332 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:50,333 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:00:50,335 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:00:50,337 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:00:50,339 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:00:50,339 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:00:50,340 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:00:50,340 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:00:50,342 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:00:50,344 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:00:50,345 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:00:50,346 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:00:50,347 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:50,348 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:50,349 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:50,349 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:50,350 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:50,350 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:00:50,353 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:51,702 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:51,702 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:51,702 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:00:51,702 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:51,705 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:53,002 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:53,003 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:53,004 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:00:53,004 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:53,010 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:54,299 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:54,299 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:54,299 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:00:54,299 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:00:54,302 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:00:55,508 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:00:55,509 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:00:55,509 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:00:55,510 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:02:24,499 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:02:24,499 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:02:24,507 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:02:24,508 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:02:24,515 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:02:24,516 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:02:24,518 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:02:24,520 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:02:24,522 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:02:24,524 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:02:24,525 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:02:24,527 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:02:24,528 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:02:24,528 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:02:24,530 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:02:24,530 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:02:24,531 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:02:24,534 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:02:24,534 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:02:24,537 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:02:24,540 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:02:24,540 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:02:24,543 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:02:24,543 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:02:24,546 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:02:24,547 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:02:24,551 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:02:26,211 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:02:26,211 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:02:26,212 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:02:26,212 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:02:26,218 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:02:27,499 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:02:27,500 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:02:27,500 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:02:27,500 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:02:27,502 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:02:28,800 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:02:28,800 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:02:28,800 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:02:28,800 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:02:28,803 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:02:30,103 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:02:30,103 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:02:30,103 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:02:30,103 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:04:22,139 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:04:22,139 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:04:22,151 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:04:22,151 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:04:22,160 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:04:22,160 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:04:22,162 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:04:22,163 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:04:22,164 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:04:22,165 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:04:22,166 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:04:22,167 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:04:22,169 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:04:22,169 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:04:22,171 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:04:22,171 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:04:22,173 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:04:22,175 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:04:22,176 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:04:22,178 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:04:22,180 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:04:22,180 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:04:22,183 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:04:22,183 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:04:22,185 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:04:22,185 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:04:22,191 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:04:23,605 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:04:23,605 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:04:23,605 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:04:23,605 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:04:23,607 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:04:24,906 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:04:24,906 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:04:24,906 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:04:24,907 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:04:24,910 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:04:26,207 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:04:26,207 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:04:26,207 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:04:26,208 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:04:26,209 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:04:27,502 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:04:27,503 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:04:27,503 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:04:27,503 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:08:35,740 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:08:35,740 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:08:35,748 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:08:35,748 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:08:35,756 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:08:35,756 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:08:49,567 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 20:08:49,568 - INFO - ler_planilha executada com excesso!
2025-08-26 20:08:49,708 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 20:08:49,708 - INFO - ler_planilha executada com excesso!
2025-08-26 20:08:49,750 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 20:08:49,751 - INFO - ler_planilha executada com excesso!
2025-08-26 20:08:49,849 - INFO - limpar_ruptura executada com excesso!
2025-08-26 20:08:49,853 - INFO - limpar_estoque executada com excesso!
2025-08-26 20:08:49,856 - INFO - limpar_vendas executada com excesso!
2025-08-26 20:08:49,911 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 20:08:49,911 - INFO - validar_df executada com excesso!
2025-08-26 20:08:49,938 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 20:08:49,938 - INFO - validar_df executada com excesso!
2025-08-26 20:08:49,955 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 20:08:49,956 - INFO - validar_df executada com excesso!
2025-08-26 20:08:49,973 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:08:49,973 - INFO - combinar_abas executada com excesso!
2025-08-26 20:08:49,978 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:08:49,978 - INFO - combinar_abas executada com excesso!
2025-08-26 20:08:49,988 - INFO - limpar_consolidado executada com excesso!
2025-08-26 20:08:50,013 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 20:08:50,013 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 20:08:50,177 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 20:08:50,178 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 20:08:50,630 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 20:08:50,630 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:08:50,892 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 20:08:50,892 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:08:50,938 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 20:08:50,938 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:08:50,939 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:08:52,407 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:08:52,408 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:08:56,792 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 20:08:56,793 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:08:56,799 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:08:58,301 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:08:58,301 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:09:02,262 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 20:09:02,263 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:09:02,267 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:09:03,599 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:09:03,599 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:09:06,650 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 20:09:06,651 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:09:06,658 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:09:08,002 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:09:08,002 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:09:12,518 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 20:09:12,518 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:10:17,950 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 20:10:17,950 - INFO - ler_planilha executada com excesso!
2025-08-26 20:10:18,085 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 20:10:18,085 - INFO - ler_planilha executada com excesso!
2025-08-26 20:10:18,125 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 20:10:18,125 - INFO - ler_planilha executada com excesso!
2025-08-26 20:10:18,137 - INFO - limpar_ruptura executada com excesso!
2025-08-26 20:10:18,139 - INFO - limpar_estoque executada com excesso!
2025-08-26 20:10:18,143 - INFO - limpar_vendas executada com excesso!
2025-08-26 20:10:18,159 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 20:10:18,159 - INFO - validar_df executada com excesso!
2025-08-26 20:10:18,186 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 20:10:18,186 - INFO - validar_df executada com excesso!
2025-08-26 20:10:18,201 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 20:10:18,201 - INFO - validar_df executada com excesso!
2025-08-26 20:10:18,207 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:10:18,207 - INFO - combinar_abas executada com excesso!
2025-08-26 20:10:18,212 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:10:18,212 - INFO - combinar_abas executada com excesso!
2025-08-26 20:10:18,222 - INFO - limpar_consolidado executada com excesso!
2025-08-26 20:10:18,241 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 20:10:18,241 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 20:10:18,383 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 20:10:18,384 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 20:10:18,663 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 20:10:18,663 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:10:18,910 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 20:10:18,910 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:10:18,948 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 20:10:18,948 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:10:18,950 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:10:20,301 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:10:20,302 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:10:23,956 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 20:10:23,957 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:10:23,963 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:10:25,400 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:10:25,400 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:10:27,963 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 20:10:27,963 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:10:27,965 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:10:29,505 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:10:29,505 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:10:32,300 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 20:10:32,301 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:10:32,304 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:10:33,599 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:10:33,599 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:10:37,685 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 20:10:37,685 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:12:56,917 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 20:12:56,918 - INFO - ler_planilha executada com excesso!
2025-08-26 20:12:57,137 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 20:12:57,138 - INFO - ler_planilha executada com excesso!
2025-08-26 20:12:57,190 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 20:12:57,190 - INFO - ler_planilha executada com excesso!
2025-08-26 20:12:57,213 - INFO - limpar_ruptura executada com excesso!
2025-08-26 20:12:57,218 - INFO - limpar_estoque executada com excesso!
2025-08-26 20:12:57,227 - INFO - limpar_vendas executada com excesso!
2025-08-26 20:12:57,248 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 20:12:57,248 - INFO - validar_df executada com excesso!
2025-08-26 20:12:57,272 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 20:12:57,272 - INFO - validar_df executada com excesso!
2025-08-26 20:12:57,285 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 20:12:57,285 - INFO - validar_df executada com excesso!
2025-08-26 20:12:57,291 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:12:57,291 - INFO - combinar_abas executada com excesso!
2025-08-26 20:12:57,295 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:12:57,296 - INFO - combinar_abas executada com excesso!
2025-08-26 20:12:57,302 - INFO - limpar_consolidado executada com excesso!
2025-08-26 20:12:57,319 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 20:12:57,320 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 20:12:57,421 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 20:12:57,422 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 20:12:57,692 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 20:12:57,693 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:12:57,931 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 20:12:57,931 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:12:57,966 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 20:12:57,967 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:12:57,968 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:12:59,298 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:12:59,298 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:02,572 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 20:13:02,572 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:02,575 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:04,300 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:04,300 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:07,896 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 20:13:07,897 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:07,916 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:09,197 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:09,197 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:12,218 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 20:13:12,218 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:12,220 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:13,509 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:13,509 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:16,903 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 20:13:16,903 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:22,364 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:13:22,364 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:13:22,378 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:13:22,379 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:13:22,386 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:13:22,386 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:13:22,388 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:13:22,389 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:13:22,391 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:13:22,392 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:13:22,395 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:13:22,396 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:13:22,397 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:13:22,398 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:13:22,399 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:13:22,399 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:13:22,401 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:13:22,402 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:13:22,402 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:13:22,403 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:13:22,404 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:13:22,404 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:13:22,406 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:13:22,406 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:13:22,408 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:13:22,409 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:13:22,412 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:23,898 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:23,899 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:23,899 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:13:23,900 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:23,905 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:25,398 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:25,399 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:25,399 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:13:25,399 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:25,403 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:26,896 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:26,896 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:26,896 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:13:26,896 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:13:26,898 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:13:28,399 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:13:28,399 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:13:28,399 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:13:28,399 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:14:26,012 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:14:26,013 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:14:26,022 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:14:26,023 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:14:26,030 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:14:26,031 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:14:26,033 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:14:26,034 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:14:26,035 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:14:26,036 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:14:26,037 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:14:26,040 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:14:26,041 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:14:26,041 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:14:26,042 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:14:26,042 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:14:26,043 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:14:26,044 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:14:26,045 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:14:26,046 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:14:26,047 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:14:26,047 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:14:26,048 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:14:26,048 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:14:26,049 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:14:26,050 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:14:26,053 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:14:27,497 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:14:27,497 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:14:27,498 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:14:27,498 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:14:27,500 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:14:29,005 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:14:29,005 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:14:29,005 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:14:29,005 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:14:29,007 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:14:30,398 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:14:30,398 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:14:30,398 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:14:30,399 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:14:30,401 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:14:31,895 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:14:31,895 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:14:31,896 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:14:31,896 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:03,281 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:15:03,281 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:15:03,318 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:15:03,318 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:15:03,355 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:15:03,355 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:15:03,357 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:03,358 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:03,359 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:03,360 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:15:03,361 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:15:03,362 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:15:03,364 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:15:03,364 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:15:03,365 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:15:03,365 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:15:03,366 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:03,367 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:15:03,368 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:15:03,369 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:15:03,370 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:03,370 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:03,371 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:03,371 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:03,373 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:03,373 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:03,376 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:04,797 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:04,798 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:04,798 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:15:04,799 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:04,802 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:06,114 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:06,114 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:06,115 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:15:06,115 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:06,116 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:07,401 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:07,402 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:07,402 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:15:07,403 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:07,408 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:08,801 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:08,801 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:08,802 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:15:08,802 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:36,831 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:15:36,832 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:15:36,894 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:15:36,895 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:15:36,943 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:15:36,943 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:15:36,946 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:36,947 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:36,948 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:36,949 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:15:36,951 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:15:36,954 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:15:36,956 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:15:36,956 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:15:36,957 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:15:36,957 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:15:36,958 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:15:36,960 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:15:36,960 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:15:36,961 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:15:36,962 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:36,962 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:36,964 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:36,965 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:36,966 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:36,966 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:15:36,970 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:38,404 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:38,404 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:38,404 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:15:38,404 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:38,406 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:39,696 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:39,696 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:39,696 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:15:39,696 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:39,700 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:40,996 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:40,996 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:40,996 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:15:40,996 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:15:40,998 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:15:42,300 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:15:42,300 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:15:42,301 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:15:42,301 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:18,742 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:16:18,742 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:16:18,791 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:16:18,791 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:16:18,850 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:16:18,850 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:16:18,854 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:18,855 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:18,856 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:18,857 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:16:18,858 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:16:18,860 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:16:18,860 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:16:18,861 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:16:18,861 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:16:18,861 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:16:18,862 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:18,864 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:16:18,864 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:16:18,866 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:16:18,867 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:18,867 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:18,869 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:18,869 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:18,871 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:18,871 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:18,875 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:20,196 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:20,197 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:20,197 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:16:20,197 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:20,201 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:21,502 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:21,502 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:21,502 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:16:21,503 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:21,506 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:22,800 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:22,800 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:22,801 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:16:22,801 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:22,805 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:24,099 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:24,100 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:24,100 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:16:24,100 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:51,359 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:16:51,359 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:16:51,404 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:16:51,404 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:16:51,442 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:16:51,442 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:16:51,444 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:51,445 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:51,445 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:51,446 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:16:51,448 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:16:51,449 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:16:51,451 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:16:51,451 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:16:51,452 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:16:51,452 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:16:51,454 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:16:51,455 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:16:51,455 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:16:51,456 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:16:51,457 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:51,457 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:51,458 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:51,459 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:51,460 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:51,460 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:16:51,462 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:52,800 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:52,800 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:52,801 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:16:52,801 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:52,805 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:54,097 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:54,098 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:54,098 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:16:54,099 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:54,104 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:55,396 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:55,396 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:55,397 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:16:55,397 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:16:55,403 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:16:56,696 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:16:56,697 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:16:56,697 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:16:56,697 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:26,652 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:18:26,652 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:18:26,717 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:18:26,717 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:18:26,773 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:18:26,773 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:18:26,776 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:26,778 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:26,780 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:26,782 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:26,783 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:26,785 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:26,786 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:18:26,787 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:18:26,788 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:18:26,789 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:18:26,790 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:26,792 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:18:26,793 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:18:26,794 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:18:26,795 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:26,796 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:26,798 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:26,798 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:26,800 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:26,800 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:26,805 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:28,203 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:28,204 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:28,204 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:18:28,204 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:28,207 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:29,496 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:29,496 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:29,496 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:18:29,496 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:29,498 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:30,796 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:30,797 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:30,797 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:18:30,797 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:30,800 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:32,290 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:32,290 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:32,290 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:18:32,290 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:32,881 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:18:32,882 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:18:32,903 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:18:32,903 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:18:32,916 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:18:32,916 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:18:32,920 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:32,921 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:32,922 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:32,923 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:32,925 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:32,927 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:32,929 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:18:32,929 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:18:32,930 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:18:32,930 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:18:32,932 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:32,936 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:18:32,936 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:18:32,937 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:18:32,939 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:32,939 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:32,941 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:32,941 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:32,944 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:32,944 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:32,948 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:34,506 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:34,506 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:34,507 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:18:34,507 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:34,513 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:35,795 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:35,795 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:35,796 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:18:35,796 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:35,800 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:37,099 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:37,100 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:37,100 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:18:37,101 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:37,106 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:18:38,396 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:18:38,396 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:18:38,397 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:18:38,397 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:18:59,635 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:18:59,636 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:18:59,644 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:18:59,644 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:18:59,655 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:18:59,655 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:18:59,657 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:59,658 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:59,660 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:59,661 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:59,662 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:59,664 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:18:59,665 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:18:59,665 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:18:59,666 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:18:59,667 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:18:59,668 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:18:59,669 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:18:59,669 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:18:59,670 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:18:59,671 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:59,671 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:59,672 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:59,672 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:59,673 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:59,673 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:18:59,676 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:00,996 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:00,996 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:00,997 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:19:00,997 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:00,999 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:02,394 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:02,395 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:02,395 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:19:02,396 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:02,402 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:03,698 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:03,699 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:03,700 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:19:03,700 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:03,705 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:04,997 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:04,998 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:04,998 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:19:04,998 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:54,087 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:19:54,088 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:19:54,102 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:19:54,102 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:19:54,108 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:19:54,108 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:19:54,110 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:19:54,112 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:19:54,112 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:19:54,128 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:19:54,131 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:19:54,132 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:19:54,133 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:19:54,133 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:19:54,137 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:19:54,137 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:19:54,138 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:19:54,140 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:19:54,140 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:19:54,142 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:19:54,143 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:19:54,143 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:19:54,145 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:19:54,145 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:19:54,147 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:19:54,147 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:19:54,151 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:55,696 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:55,696 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:55,696 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:19:55,696 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:55,699 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:57,092 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:57,092 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:57,092 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:19:57,092 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:57,094 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:58,497 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:58,497 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:58,497 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:19:58,497 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:19:58,499 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:19:59,901 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:19:59,901 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:19:59,901 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:19:59,901 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:21:19,319 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:21:19,320 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:21:19,334 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:21:19,334 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:21:19,342 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:21:19,342 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:21:19,345 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:21:19,346 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:21:19,347 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:21:19,366 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:21:19,369 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:21:19,370 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:21:19,372 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:21:19,372 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:21:19,375 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:21:19,375 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:21:19,376 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:21:19,377 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:21:19,378 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:21:19,379 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:21:19,380 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:21:19,381 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:21:19,383 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:21:19,383 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:21:19,384 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:21:19,384 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:21:19,388 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:21:21,296 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:21:21,297 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:21:21,297 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:21:21,297 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:21:21,298 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:21:22,899 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:21:22,899 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:21:22,900 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:21:22,900 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:21:22,902 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:21:24,390 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:21:24,391 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:21:24,391 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:21:24,391 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:21:24,393 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:21:25,896 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:21:25,896 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:21:25,896 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:21:25,896 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:23:48,756 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:23:48,756 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:23:48,770 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:23:48,770 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:23:48,780 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:23:48,780 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:23:48,783 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:23:48,784 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:23:48,785 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:23:48,786 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:23:48,788 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:23:48,789 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:23:48,790 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:23:48,791 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:23:48,792 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:23:48,792 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:23:48,793 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:23:48,794 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:23:48,794 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:23:48,795 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:23:48,797 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:23:48,797 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:23:48,800 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:23:48,800 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:23:48,802 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:23:48,802 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:23:48,807 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:23:50,396 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:23:50,396 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:23:50,396 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:23:50,396 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:23:50,398 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:23:51,691 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:23:51,691 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:23:51,691 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:23:51,691 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:23:51,693 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:23:52,996 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:23:52,996 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:23:52,996 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:23:52,996 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:23:52,998 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:23:54,290 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:23:54,290 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:23:54,291 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:23:54,291 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:09,724 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:25:09,724 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:25:09,733 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:25:09,733 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:25:09,743 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:25:09,743 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:25:09,744 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:09,745 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:09,746 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:09,747 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:25:09,748 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:25:09,749 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:25:09,751 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:25:09,751 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:25:09,753 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:25:09,753 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:25:09,756 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:09,759 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:25:09,760 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:25:09,762 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:25:09,763 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:09,763 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:09,766 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:09,766 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:09,768 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:09,768 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:09,774 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:11,295 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:11,295 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:11,296 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:25:11,296 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:11,301 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:12,700 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:12,701 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:12,702 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:25:12,702 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:12,708 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:13,995 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:13,996 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:13,996 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:25:13,997 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:14,003 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:15,493 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:15,493 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:15,493 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:25:15,494 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:28,353 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:25:28,353 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:25:28,361 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:25:28,361 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:25:28,370 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:25:28,370 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:25:28,372 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:28,374 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:28,375 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:28,378 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:25:28,380 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:25:28,381 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:25:28,383 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:25:28,383 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:25:28,384 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:25:28,384 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:25:28,386 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:25:28,387 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:25:28,388 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:25:28,389 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:25:28,390 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:28,390 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:28,392 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:28,392 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:28,395 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:28,395 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:25:28,398 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:29,795 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:29,795 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:29,795 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:25:29,795 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:29,797 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:31,091 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:31,091 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:31,091 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:25:31,091 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:31,094 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:32,499 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:32,500 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:32,500 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:25:32,500 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:25:32,506 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:25:33,794 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:25:33,795 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:25:33,795 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:25:33,795 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:26:56,340 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:26:56,341 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:26:56,355 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:26:56,355 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:26:56,365 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:26:56,365 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:26:56,367 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:26:56,367 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:26:56,368 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:26:56,369 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:26:56,370 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:26:56,371 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:26:56,372 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:26:56,372 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:26:56,374 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:26:56,374 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:26:56,376 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:26:56,377 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:26:56,378 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:26:56,379 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:26:56,380 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:26:56,380 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:26:56,382 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:26:56,382 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:26:56,384 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:26:56,384 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:26:56,388 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:26:57,892 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:26:57,892 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:26:57,892 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:26:57,893 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:26:57,894 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:26:59,095 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:26:59,095 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:26:59,096 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:26:59,096 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:26:59,099 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:27:00,392 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:27:00,392 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:27:00,392 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:27:00,392 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:27:00,394 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:27:01,795 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:27:01,795 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:27:01,795 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:27:01,795 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:30:11,832 - ERROR - Aba "01_BD_Ruptura_Faltaproduto" não encontrada.
2025-08-26 20:30:11,832 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Aba "01_BD_Ruptura_Faltaproduto" não encontrada.
2025-08-26 20:30:11,832 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 27, in ler_planilha
    raise RuntimeError(msg)
RuntimeError: Aba "01_BD_Ruptura_Faltaproduto" não encontrada.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 35, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Aba "01_BD_Ruptura_Faltaproduto" não encontrada.) ao tentar ler a planilha!
2025-08-26 20:30:11,843 - ERROR - Aba "02_BD_Estoque" não encontrada.
2025-08-26 20:30:11,843 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Aba "02_BD_Estoque" não encontrada.
2025-08-26 20:30:11,843 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 27, in ler_planilha
    raise RuntimeError(msg)
RuntimeError: Aba "02_BD_Estoque" não encontrada.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 35, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Aba "02_BD_Estoque" não encontrada.) ao tentar ler a planilha!
2025-08-26 20:30:11,848 - ERROR - Aba "03_BD_Vendas" não encontrada.
2025-08-26 20:30:11,848 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Aba "03_BD_Vendas" não encontrada.
2025-08-26 20:30:11,848 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 27, in ler_planilha
    raise RuntimeError(msg)
RuntimeError: Aba "03_BD_Vendas" não encontrada.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 35, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Aba "03_BD_Vendas" não encontrada.) ao tentar ler a planilha!
2025-08-26 20:30:11,848 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:30:11,849 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:30:11,850 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:30:11,866 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:30:11,869 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:30:11,870 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:30:11,871 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:30:11,871 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:30:11,875 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:30:11,875 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:30:11,876 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:30:11,877 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:30:11,877 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:30:11,878 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:30:11,879 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:30:11,879 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:30:11,881 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:30:11,881 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:30:11,882 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:30:11,882 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:30:11,885 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:30:13,395 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:30:13,395 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:30:13,395 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:30:13,395 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:30:13,398 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:30:14,993 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:30:14,993 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:30:14,994 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:30:14,994 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:30:14,996 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:30:16,489 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:30:16,490 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:30:16,490 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:30:16,491 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:30:16,496 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:30:17,792 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:30:17,792 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:30:17,792 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:30:17,793 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:11,985 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:31:11,986 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:31:11,996 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:31:11,996 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:31:12,005 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:31:12,005 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:31:12,007 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:12,008 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:12,009 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:12,010 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:31:12,011 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:31:12,012 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:31:12,013 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:31:12,014 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:31:12,014 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:31:12,014 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:31:12,015 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:12,016 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:31:12,017 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:31:12,018 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:31:12,019 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:12,019 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:12,021 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:12,021 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:12,024 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:12,024 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:12,032 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:13,490 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:13,490 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:13,490 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:31:13,490 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:13,492 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:14,792 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:14,792 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:14,793 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:31:14,793 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:14,798 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:16,090 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:16,091 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:16,092 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:31:16,092 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:16,098 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:17,394 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:17,395 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:17,395 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:31:17,395 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:29,913 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:31:29,913 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:31:29,921 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:31:29,922 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:31:29,930 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:31:29,930 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:31:29,932 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:29,933 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:29,933 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:29,935 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:31:29,936 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:31:29,937 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:31:29,938 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:31:29,938 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:31:29,939 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:31:29,939 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:31:29,941 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:31:29,942 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:31:29,942 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:31:29,943 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:31:29,945 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:29,945 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:29,946 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:29,947 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:29,948 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:29,948 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:31:29,952 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:31,386 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:31,386 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:31,386 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:31:31,386 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:31,388 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:32,789 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:32,789 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:32,789 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:31:32,790 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:32,794 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:33,996 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:33,996 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:33,997 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:31:33,997 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:31:34,003 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:31:35,386 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:31:35,386 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:31:35,386 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:31:35,386 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:32:32,218 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:32:32,218 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:32:32,229 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:32:32,229 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:32:32,236 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:32:32,236 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:32:32,238 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:32:32,239 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:32:32,240 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:32:32,240 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:32:32,241 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:32:32,242 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:32:32,244 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:32:32,244 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:32:32,245 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:32:32,245 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:32:32,246 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:32:32,249 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:32:32,249 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:32:32,250 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:32:32,252 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:32:32,252 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:32:32,254 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:32:32,254 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:32:32,256 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:32:32,256 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:32:32,262 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:32:33,688 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:32:33,688 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:32:33,688 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:32:33,688 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:32:33,690 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:32:34,996 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:32:34,996 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:32:34,996 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:32:34,996 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:32:34,998 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:32:36,286 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:32:36,287 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:32:36,287 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:32:36,288 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:32:36,294 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:32:37,787 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:32:37,787 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:32:37,788 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:32:37,788 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:34:48,899 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:34:48,899 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:34:48,911 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:34:48,912 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:34:48,924 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:34:48,924 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:34:48,926 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:34:48,927 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:34:48,928 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:34:48,929 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:34:48,930 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:34:48,931 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:34:48,932 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:34:48,932 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:34:48,933 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:34:48,933 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:34:48,935 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:34:48,936 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:34:48,937 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:34:48,938 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:34:48,939 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:34:48,940 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:34:48,941 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:34:48,941 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:34:48,942 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:34:48,943 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:34:48,947 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:34:50,394 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:34:50,394 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:34:50,394 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:34:50,394 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:34:50,395 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:34:51,788 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:34:51,789 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:34:51,790 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:34:51,790 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:34:51,794 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:34:53,196 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:34:53,196 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:34:53,197 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:34:53,197 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:34:53,203 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:34:54,486 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:34:54,486 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:34:54,487 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:34:54,487 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:36:54,691 - ERROR - Aba "01_BD_Ruptura_Faltaproduto" não encontrada.
2025-08-26 20:36:54,691 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 20, in ler_planilha
    raise RuntimeError(msg)
RuntimeError: Aba "01_BD_Ruptura_Faltaproduto" não encontrada.
2025-08-26 20:36:54,699 - ERROR - Aba "02_BD_Estoque" não encontrada.
2025-08-26 20:36:54,700 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 20, in ler_planilha
    raise RuntimeError(msg)
RuntimeError: Aba "02_BD_Estoque" não encontrada.
2025-08-26 20:36:54,706 - ERROR - Aba "03_BD_Vendas" não encontrada.
2025-08-26 20:36:54,706 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 20, in ler_planilha
    raise RuntimeError(msg)
RuntimeError: Aba "03_BD_Vendas" não encontrada.
2025-08-26 20:36:54,707 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:36:54,708 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:36:54,709 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:36:54,710 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:36:54,712 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:36:54,713 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:36:54,714 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:36:54,714 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:36:54,715 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:36:54,715 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:36:54,716 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:36:54,718 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:36:54,718 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:36:54,719 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:36:54,720 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:36:54,720 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:36:54,722 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:36:54,722 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:36:54,724 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:36:54,724 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:36:54,727 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:36:56,293 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:36:56,294 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:36:56,294 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:36:56,294 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:36:56,296 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:36:57,596 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:36:57,596 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:36:57,597 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:36:57,597 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:36:57,600 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:36:58,893 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:36:58,893 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:36:58,894 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:36:58,894 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:36:58,900 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:37:00,297 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:37:00,297 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:37:00,297 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:37:00,297 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:38:22,470 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:38:22,470 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:38:22,481 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:38:22,481 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:38:22,489 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:38:22,489 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:38:22,492 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:38:22,499 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:38:22,499 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:39:44,094 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:39:44,094 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 24, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:39:44,107 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:39:44,107 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 24, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:39:44,115 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:39:44,115 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 24, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:39:44,117 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:39:44,118 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:39:44,119 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:39:44,120 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:39:44,122 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:39:44,124 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:39:44,126 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:39:44,126 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:39:44,127 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:39:44,128 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:39:44,130 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:39:44,132 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:39:44,132 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:39:44,134 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:39:44,135 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:39:44,135 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:39:44,137 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:39:44,137 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:39:44,139 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:39:44,139 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:39:44,143 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:39:45,490 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:39:45,491 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:39:45,491 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:39:45,491 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:39:45,493 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:39:46,787 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:39:46,787 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:39:46,788 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:39:46,788 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:39:46,794 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:39:48,093 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:39:48,093 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:39:48,093 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:39:48,093 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:39:48,097 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:39:49,582 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:39:49,582 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:39:49,582 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:39:49,583 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:42:09,084 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:42:09,084 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:42:09,095 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:42:09,096 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:42:09,101 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:42:09,101 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:42:58,286 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:42:58,286 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:42:58,297 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:42:58,297 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:42:58,305 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:42:58,306 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:43:13,549 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:43:13,549 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:43:13,559 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:43:13,560 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:43:13,568 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:43:13,568 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:43:30,913 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 20:43:30,913 - INFO - ler_planilha executada com excesso!
2025-08-26 20:43:31,037 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 20:43:31,037 - INFO - ler_planilha executada com excesso!
2025-08-26 20:43:31,080 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 20:43:31,080 - INFO - ler_planilha executada com excesso!
2025-08-26 20:43:31,117 - INFO - limpar_ruptura executada com excesso!
2025-08-26 20:43:31,119 - INFO - limpar_estoque executada com excesso!
2025-08-26 20:43:31,122 - INFO - limpar_vendas executada com excesso!
2025-08-26 20:43:31,176 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 20:43:31,176 - INFO - validar_df executada com excesso!
2025-08-26 20:43:31,194 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 20:43:31,194 - INFO - validar_df executada com excesso!
2025-08-26 20:43:31,204 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 20:43:31,204 - INFO - validar_df executada com excesso!
2025-08-26 20:43:31,226 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:43:31,226 - INFO - combinar_abas executada com excesso!
2025-08-26 20:43:31,231 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:43:31,231 - INFO - combinar_abas executada com excesso!
2025-08-26 20:43:31,238 - INFO - limpar_consolidado executada com excesso!
2025-08-26 20:43:31,255 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 20:43:31,256 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 20:43:31,380 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 20:43:31,381 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 20:43:31,719 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 20:43:31,719 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:43:32,008 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 20:43:32,008 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:43:32,046 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 20:43:32,047 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:43:32,048 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:43:33,488 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:43:33,488 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:43:36,553 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 20:43:36,553 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:43:36,555 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:43:37,885 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:43:37,885 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:43:41,494 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 20:43:41,494 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:43:41,498 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:43:42,885 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:43:42,886 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:43:46,641 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 20:43:46,642 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:43:46,648 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:43:47,990 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:43:47,991 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:43:50,746 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 20:43:50,747 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:35,362 - INFO - Planilha "01_BD_Ruptura_Faltaproduto" lida com sucesso.
2025-08-26 20:46:35,363 - INFO - ler_planilha executada com excesso!
2025-08-26 20:46:35,484 - INFO - Planilha "02_BD_Estoque" lida com sucesso.
2025-08-26 20:46:35,484 - INFO - ler_planilha executada com excesso!
2025-08-26 20:46:35,517 - INFO - Planilha "03_BD_Vendas" lida com sucesso.
2025-08-26 20:46:35,517 - INFO - ler_planilha executada com excesso!
2025-08-26 20:46:35,528 - INFO - limpar_ruptura executada com excesso!
2025-08-26 20:46:35,530 - INFO - limpar_estoque executada com excesso!
2025-08-26 20:46:35,532 - INFO - limpar_vendas executada com excesso!
2025-08-26 20:46:35,545 - INFO - DataFrame validado com sucesso: ruptura!
2025-08-26 20:46:35,545 - INFO - validar_df executada com excesso!
2025-08-26 20:46:35,564 - INFO - DataFrame validado com sucesso: estoque!
2025-08-26 20:46:35,564 - INFO - validar_df executada com excesso!
2025-08-26 20:46:35,579 - INFO - DataFrame validado com sucesso: vendas!
2025-08-26 20:46:35,579 - INFO - validar_df executada com excesso!
2025-08-26 20:46:35,585 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:46:35,585 - INFO - combinar_abas executada com excesso!
2025-08-26 20:46:35,590 - INFO - Planilhas combinadas (join) com sucesso!
2025-08-26 20:46:35,591 - INFO - combinar_abas executada com excesso!
2025-08-26 20:46:35,599 - INFO - limpar_consolidado executada com excesso!
2025-08-26 20:46:35,613 - INFO - Arquivo consolidado exportado com sucesso: C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\analise_consolidada.csv
2025-08-26 20:46:35,614 - INFO - exportar_csv_consolidado executada com excesso!
2025-08-26 20:46:35,685 - INFO - Planilhas individuais salvas com sucesso.
2025-08-26 20:46:35,686 - INFO - exportar_por_cliente executada com excesso!
2025-08-26 20:46:35,917 - INFO - Arquivo ruptura_faltaproduto.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\ruptura_faltaproduto.xlsx!
2025-08-26 20:46:35,917 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:46:36,157 - INFO - Arquivo estoque.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\estoque.xlsx!
2025-08-26 20:46:36,157 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:46:36,194 - INFO - Arquivo vendas.xlsx salvo com sucesso em C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\data\processed\vendas.xlsx!
2025-08-26 20:46:36,194 - INFO - exportar_xlsx executada com excesso!
2025-08-26 20:46:36,196 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:37,685 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:37,686 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:40,705 - INFO - Tabela "poetic-standard-439816-e6.varejo.ruptura_faltaproduto" criada e dados enviados com sucesso!
2025-08-26 20:46:40,705 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:40,710 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:41,671 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto
2025-08-26 20:46:41,671 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 23, in ler_planilha
    raise RuntimeError(f'Erro ao tentar ler a planilha!')
RuntimeError: Erro ao tentar ler a planilha!
2025-08-26 20:46:41,686 - ERROR - Erro ao ler a planilha "02_BD_Estoque
2025-08-26 20:46:41,686 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 23, in ler_planilha
    raise RuntimeError(f'Erro ao tentar ler a planilha!')
RuntimeError: Erro ao tentar ler a planilha!
2025-08-26 20:46:41,696 - ERROR - Erro ao ler a planilha "03_BD_Vendas
2025-08-26 20:46:41,696 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 23, in ler_planilha
    raise RuntimeError(f'Erro ao tentar ler a planilha!')
RuntimeError: Erro ao tentar ler a planilha!
2025-08-26 20:46:41,700 - ERROR - Erro em limpar_ruptura
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 88, in limpar_ruptura
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:46:41,701 - ERROR - Erro em limpar_estoque
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 107, in limpar_estoque
    df = (df.pipe(_coletar_mes, coluna_mes='MES', num_digitos=3)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:46:41,702 - ERROR - Erro em limpar_vendas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 121, in limpar_vendas
    df = (df.pipe(_separar_ano_mes, coluna_data='DT_MES', num_digitos=6)
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:46:41,703 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:46:41,706 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:46:41,709 - ERROR - Erro em validar_df
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\validate.py", line 147, in validar_df
    validate_df = schema.validate(df, lazy=True)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 117, in validate
    return self._validate(
           ~~~~~~~~~~~~~~^
        check_obj=check_obj,
        ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        inplace=inplace,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\pandas\container.py", line 138, in _validate
    return self.get_backend(check_obj).validate(
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandera\api\base\schema.py", line 124, in get_backend
    raise BackendNotFoundError(
    ...<2 lines>...
    )
pandera.errors.BackendNotFoundError: Backend not found for backend, class: (<class 'pandera.api.pandas.container.DataFrameSchema'>, <class 'RuntimeError'>). Looked up the following base classes: (<class 'RuntimeError'>, <class 'Exception'>, <class 'BaseException'>, <class 'object'>)
2025-08-26 20:46:41,710 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:46:41,711 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:46:41,715 - ERROR - Erro ao tentar combinar (join) as planilhas: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed
2025-08-26 20:46:41,715 - ERROR - Erro em combinar_abas
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 14, in combinar_abas
    consolidado = pd.merge(df1, df2, left_on=left_chave, right_on=right_chave, how=join)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 152, in merge
    left_df = _validate_operand(left)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\core\reshape\merge.py", line 2692, in _validate_operand
    raise TypeError(
        f"Can only merge Series or DataFrame objects, a {type(obj)} was passed"
    )
TypeError: Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\merge.py", line 19, in combinar_abas
    raise RuntimeError(f'Erro ({error}) ao tentar consolidar as planilhas!')
RuntimeError: Erro (Can only merge Series or DataFrame objects, a <class 'RuntimeError'> was passed) ao tentar consolidar as planilhas!
2025-08-26 20:46:41,717 - ERROR - Erro em limpar_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\transform\transform.py", line 162, in limpar_consolidado
    df = (df.pipe(_remover_colunas, colunas=['ANO_y', 'NOME_CLIENTE', 'DESCRICAO_CATEGORIA'])
          ^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'pipe'
2025-08-26 20:46:41,718 - ERROR - Erro ao exportar arquivo consolidado: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:46:41,719 - ERROR - Erro em exportar_csv_consolidado
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_csv.py", line 19, in exportar_csv_consolidado
    df.to_csv(ENDERECO, index=False, encoding='utf-8-sig')
    ^^^^^^^^^
AttributeError: 'AttributeError' object has no attribute 'to_csv'
2025-08-26 20:46:41,720 - ERROR - Erro em exportar_por_cliente
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 26, in exportar_por_cliente
    planilhas_individuais = _filtrar_cliente(df)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_directory.py", line 16, in _filtrar_cliente
    codigos = df['COD_CLIENTE'].unique().tolist()
              ~~^^^^^^^^^^^^^^^
TypeError: 'AttributeError' object is not subscriptable
2025-08-26 20:46:41,721 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:46:41,721 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:46:41,723 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:46:41,723 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:46:41,725 - ERROR - Erro ao gerar xlsx: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:46:41,726 - ERROR - Erro em exportar_xlsx
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\load\to_xlsx.py", line 20, in exportar_xlsx
    df.to_excel(ENDERECO, index=False, engine='openpyxl')
    ^^^^^^^^^^^
AttributeError: 'RuntimeError' object has no attribute 'to_excel'
2025-08-26 20:46:41,730 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:42,295 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:42,295 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:43,283 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:43,283 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:43,283 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:46:43,283 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:43,293 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:44,582 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:44,582 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:44,583 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:46:44,583 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:44,586 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:45,185 - INFO - Tabela "poetic-standard-439816-e6.varejo.estoque" criada e dados enviados com sucesso!
2025-08-26 20:46:45,186 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:45,193 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:46,106 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:46,106 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:46,107 - ERROR - Erro ao enviar dados para o BigQuery: 'RuntimeError' object has no attribute 'reset_index'
2025-08-26 20:46:46,107 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:46,108 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:46,679 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:46,679 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:47,486 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:47,487 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:47,488 - ERROR - Erro ao enviar dados para o BigQuery: 'AttributeError' object has no attribute 'reset_index'
2025-08-26 20:46:47,488 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:50,050 - INFO - Tabela "poetic-standard-439816-e6.varejo.vendas" criada e dados enviados com sucesso!
2025-08-26 20:46:50,050 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:46:50,052 - INFO - Conexão com BigQuery criada com sucesso!
2025-08-26 20:46:51,682 - INFO - Dataset poetic-standard-439816-e6.varejo criado ou já existente.
2025-08-26 20:46:51,682 - INFO - _criar_dataset executada com excesso!
2025-08-26 20:46:54,668 - INFO - Tabela "poetic-standard-439816-e6.varejo.consolidado" criada e dados enviados com sucesso!
2025-08-26 20:46:54,668 - INFO - enviar_tabela_bq executada com excesso!
2025-08-26 20:48:49,431 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:48:49,431 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:48:49,441 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:48:49,442 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:48:49,451 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:48:49,452 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
2025-08-26 20:49:20,876 - ERROR - Erro ao ler a planilha "01_BD_Ruptura_Faltaproduto": Worksheet named '01_BD_Ruptura_Faltaproduto' not found
2025-08-26 20:49:20,877 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '01_BD_Ruptura_Faltaproduto' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '01_BD_Ruptura_Faltaproduto' not found) ao tentar ler a planilha!
2025-08-26 20:49:20,889 - ERROR - Erro ao ler a planilha "02_BD_Estoque": Worksheet named '02_BD_Estoque' not found
2025-08-26 20:49:20,889 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '02_BD_Estoque' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '02_BD_Estoque' not found) ao tentar ler a planilha!
2025-08-26 20:49:20,902 - ERROR - Erro ao ler a planilha "03_BD_Vendas": Worksheet named '03_BD_Vendas' not found
2025-08-26 20:49:20,902 - ERROR - Erro em ler_planilha
Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 17, in ler_planilha
    planilha = pd.read_excel(endereco, sheet_name=aba)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 508, in read_excel
    data = io.parse(
        sheet_name=sheet_name,
    ...<21 lines>...
        dtype_backend=dtype_backend,
    )
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 1616, in parse
    return self._reader.parse(
           ~~~~~~~~~~~~~~~~~~^
        sheet_name=sheet_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwds,
        ^^^^^^^
    )
    ^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 773, in parse
    sheet = self.get_sheet_by_name(asheetname)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 582, in get_sheet_by_name
    self.raise_if_bad_sheet_by_name(name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\.venv\Lib\site-packages\pandas\io\excel\_base.py", line 624, in raise_if_bad_sheet_by_name
    raise ValueError(f"Worksheet named '{name}' not found")
ValueError: Worksheet named '03_BD_Vendas' not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\utils\log.py", line 21, in wrapper
    result = func(*args, **kwargs)
  File "C:\Users\Acer\Downloads\VS_Code\Projetos e Estudos\- PROCESSO SELETIVO - PREPARAÇÃO\12. Cases Técnicos\case_gb\src\extract\extract.py", line 22, in ler_planilha
    raise RuntimeError(f'Erro ({error}) ao tentar ler a planilha!')
RuntimeError: Erro (Worksheet named '03_BD_Vendas' not found) ao tentar ler a planilha!
